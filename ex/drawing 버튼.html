<!DOCTYPE html>
<html>
    <head>
        <title>그림판</title>
        <style>
            body {
                margin: 0 auto;
                text-align: center;
            }
            #canvas {
                border: 1.4px solid black;
                border-radius: 5px;
                box-shadow: 0 0 5px 0px rgba(0, 0, 0, 0.1);
                margin: 20px;
            }
            .btnList {
                margin: 20px;
            }
            button {
                padding: 0;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                margin: 0 2px;
                border: none;
                cursor: pointer;
            }
            button:hover {
                box-shadow: inset 2px 2px 2px 0px rgba(255, 255, 255, 0.5), 4px 4px 5px 0px rgba(0, 0, 0, 0.1);
            }
            button.selected {
                box-shadow: inset 2px 2px 2px 0px rgba(255, 255, 255, 0.5), 4px 4px 5px 0px rgba(0, 0, 0, 0.1);
            }

            #eraseButton {
                background: white url(./img/erage.svg) center/contain;
                border: 1.4px solid #666;
                box-sizing: border-box;
            }
            label {
                display: inline-block;
                padding: 0 15px;
                font-size: 20px;
                font-weight: 600;
            }

            #clearCanvasButton {
                width: 112px;
                height: 40px;
                background: #3273f6;
                border-radius: 50px;
                color: white;
                font-size: 18px;
                font-weight: 500;
            }
        </style>
    </head>
    <body>
        <canvas id="canvas" width="500" height="500"></canvas>
        <label>
            LINE WIDTH
            <input type="range" id="lineWidthRange" min="1.5" max="20" value="1.5" />
        </label>
        <button id="clearCanvasButton">RESET</button>
        <div class="btnList">
            <button class="color-button selected" id="blackButton" style="background-color: black"></button>
            <button class="color-button" id="redButton" style="background-color: red"></button>
            <button class="color-button" id="pinkButton" style="background-color: pink"></button>
            <button class="color-button" id="orangeButton" style="background-color: orange"></button>
            <button class="color-button" id="yellowButton" style="background-color: yellow"></button>
            <button class="color-button" id="yellowgreenButton" style="background-color: yellowgreen"></button>
            <button class="color-button" id="greenButton" style="background-color: green"></button>
            <button class="color-button" id="skyBlueButton" style="background-color: skyblue"></button>
            <button class="color-button" id="blueButton" style="background-color: blue"></button>
            <button class="color-button" id="navyButton" style="background-color: navy"></button>
            <button class="color-button" id="purpleButton" style="background-color: purple"></button>
            <button id="eraseButton"></button>
        </div>

        <script>
            // 캔버스 요소 가져오기
            const canvas = document.getElementById("canvas");
            const context = canvas.getContext("2d");

            // 그리기 상태 초기화
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;

            // 마우스 이벤트 처리
            canvas.addEventListener("mousedown", startDrawing);
            canvas.addEventListener("mousemove", draw);
            canvas.addEventListener("mouseup", stopDrawing);
            canvas.addEventListener("mouseout", stopDrawing);

            // 그리기 시작
            function startDrawing(event) {
                isDrawing = true;
                [lastX, lastY] = [event.offsetX + 0.5, event.offsetY + 0.5];
            }

            // 그리기 중
            function draw(event) {
                if (!isDrawing) return;
                context.beginPath();
                context.moveTo(lastX, lastY);
                context.lineTo(event.offsetX + 0.5, event.offsetY + 0.5);
                context.strokeStyle = getSelectedColor();
                context.lineWidth = document.getElementById("lineWidthRange").value;
                context.lineJoin = "round"; // 선의 모서리를 부드럽게 연결
                context.globalCompositeOperation = document.getElementById("eraseButton").checked ? "destination-out" : "source-over";
                context.stroke();
                [lastX, lastY] = [event.offsetX + 0.5, event.offsetY + 0.5];
            }

            // 그리기 중지
            function stopDrawing() {
                isDrawing = false;
            }

            // 전체 지우기 버튼 클릭 이벤트 처리
            document.getElementById("clearCanvasButton").addEventListener("click", clearCanvas);

            // 지우개 버튼 클릭 이벤트 처리
            document.getElementById("eraseButton").addEventListener("click", toggleEraseMode);

            // 캔버스 초기화
            function clearCanvas() {
                context.clearRect(0, 0, canvas.width, canvas.height);
            }

            // 선택된 색상 가져오기
            function getSelectedColor() {
                const selectedColorButton = document.querySelector(".color-button.selected");
                if (selectedColorButton) {
                    return selectedColorButton.style.backgroundColor;
                }
                return "black"; // 기본값
            }

            // 버튼 클릭 이벤트 처리
            const colorButtons = document.querySelectorAll(".color-button");
            colorButtons.forEach((button) => {
                button.addEventListener("click", () => {
                    eraseButton.checked = false;
                    eraseButton.classList.remove("selected");
                    colorButtons.forEach((btn) => {
                        btn.classList.remove("selected");
                    });
                    button.classList.add("selected");
                });
            });

            // 지우개 모드 키기
            function toggleEraseMode() {
                const eraseButton = document.getElementById("eraseButton");
                eraseButton.classList.add("selected");
                eraseButton.checked = true;
            }
        </script>
    </body>
</html>
